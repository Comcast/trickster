#
# Trickster 2.0 Example Configuration File - Simple HTTP Reverse Proxy Cache
#
# To use this, run: trickster -config /path/to/simple.reverseproxycache.conf
#
# This file demonstrates a basic configuration for operating an
# HTTP Reverse Proxy Cache using Trickster. More documentation is
# available at https://github.com/tricksterproxy/trickster/docs/
#
# Copyright 2018 Comcast Cable Communications Management, LLC
#

frontend:
  listen_port: 8480

backends:

  # a Prometheus tsmerge alb
  promalb:
    provider: alb
    alb:
      pool: [ prom1, prom1 ]
      mechanism: tsm

  # a reverse proxy cache round-robin alb
  proxycache:
    provider: alb
    alb:
      pool: [ origin1, origin2 ]
      mechanism: rr

  # now define the pool members

  prom1:
    provider: prometheus
    origin_url: "http://prom1:9090"

  prom2:
    provider: prometheus
    origin_url: "http://prom2:9090"

  ## 

  origin1:
    provider: rpc
    origin_url: "https://origin1/"
    healthcheck:
      path: /health

  origin2:
    provider: rp # this one will not go through the cache
    origin_url: "http://origin2" # and will not use TLS
    healthcheck:
      path: /health

  